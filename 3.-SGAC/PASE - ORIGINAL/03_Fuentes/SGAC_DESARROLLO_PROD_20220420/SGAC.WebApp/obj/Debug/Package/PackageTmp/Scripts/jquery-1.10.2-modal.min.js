/**
*
* '||''|.                            '||
*  ||   ||    ....  .... ...   ....   ||    ...   ... ...  ... ..
*  ||    || .|...||  '|.  |  .|...||  ||  .|  '|.  ||'  ||  ||' ''
*  ||    || ||        '|.|   ||       ||  ||   ||  ||    |  ||
* .||...|'   '|...'    '|     '|...' .||.  '|..|'  ||...'  .||.
*                                                  ||
* --------------- By Carlos Hernández Ledesma ------------- '''' -----------
*
*/



function showModalPopup(url, title, height, width, evento) {
    window.scroll(0, 0);
    var layer_width = document.documentElement.clientWidth + document.documentElement.scrollLeft;
    var layer_height = document.documentElement.clientHeight + document.documentElement.scrollTop;

    var size = { 'height': height, 'width': width };

    var layer = document.createElement('div');
    var layer_Window = document.createElement('div');
    var layer_Window_Title = document.createElement('div');
    var layer_Window_Content = document.createElement('div');
    var layer_Window_Close = document.createElement('a');
    var layer_Window_Close_Text = document.createTextNode('Cerrar');
    var iframe = document.createElement('iframe');
    var layer_Window_strong = document.createElement('strong');
    var layer_Window_strong_Text = document.createTextNode(title);


    layer.setAttribute('class', 'divOverlay');
    layer_Window_Content.setAttribute('class', 'clsVentanaContenido');
    layer_Window_Title.setAttribute('class', 'clsVentanaTitulo');
    layer_Window.setAttribute('class', 'divVentana');
    layer_Window.setAttribute("style", "width: " + size.width + "px; height: " + size.height + "px; border: solid 1px #ccc; position: fixed; top: 50%; margin-top: -" + (size.height - document.documentElement.scrollTop) / 2 + "px; left: 50%; margin-left: -" + (size.width / 2) + "px; border-radius: 5px 5px 5px 5px; box-shadow: 0 0 15px #999; background: #fff; 	z-index: 99999; 	display: none;");
    layer_Window_Close.setAttribute('class', 'clsVentanaCerrar');


    layer.id = "divOverlay";
    layer.style.opacity = .5;
    layer.style.display = 'none';

    layer_Window.id = "divVentana";
    

    
    iframe.src = url;
    iframe.style.height = (size.height - 55) + 'px';
    iframe.style.width = (size.width - 25) + 'px';



    layer_Window_Close.onclick = function () {

        $(layer_Window).fadeOut(300, function () {
            document.body.removeChild(layer_Window);

            $(layer).fadeOut(500, function () {
                //eliminamos el overlay del DOM
                $(layer).remove();
            });
        });

        if (evento != null && evento!='') {
            document.getElementById(evento).click();
        }
    }


    layer_Window_Close.appendChild(layer_Window_Close_Text)
    layer_Window_strong.appendChild(layer_Window_strong_Text)
    layer_Window_Title.appendChild(layer_Window_strong);
    layer_Window_Title.appendChild(layer_Window_Close);
    layer_Window_Content.appendChild(iframe);


    
    document.body.appendChild(layer);

    $(".divOverlay").fadeIn(function () {
        document.body.appendChild(layer_Window);

        $(".divVentana").fadeIn();
    });


    layer_Window.appendChild(layer_Window_Title);
    layer_Window.appendChild(layer_Window_Content);
}


function close_ModalPopup(evento) {

    var s_Elementos_Ventana = $('[id^=divVentana]');
    var s_Elementos_Overlay = $('[id^=divOverlay]');

    var i_Total = s_Elementos_Ventana.length;

    var iframe = s_Elementos_Ventana[i_Total-1];
    var layer = s_Elementos_Overlay[i_Total-1];

    $(iframe).fadeOut(300, function () {
        document.body.removeChild(iframe);
        $(layer).fadeOut(500, function () {
            //eliminamos el overlay del DOM
            $(layer).remove();
        });
    });

    if (evento != null && evento != '') {
        document.getElementById(evento).click();
    }
}


var VentanaModal;

function abrirVentana(url, title, height, width, evento) {
    //guardo la referencia de la ventana para poder utilizarla luego 
    VentanaModal = window.open(url, title, 'scrollbars=1,resizable=1,width=' + width + ',height=' + height + ',left=100,top=100');

}

function cerrarVentana() {
    //la referencia de la ventana es el objeto window del popup. Lo utilizo para acceder al método close
    window.opener.document.location.reload();
    self.close();
}
